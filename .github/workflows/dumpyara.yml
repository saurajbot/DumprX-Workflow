name: Dump

on:
  push:
    paths-ignore:
      - '*.md'
    branches: [ main ]

defaults:
  run:
    shell: bash

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
       - name: Checkouts
         uses: actions/checkout@v2

       - name: Clone Dumpyara
         run: |
              git clone --depth=1 --single-branch https://github.com/saurajbot/DumprX.git phoenix_firmware_dumper
              T_CID=$(cat temp/ch_id.txt)
              T_MID=$(cat temp/msg_id.txt)
              echo "$T_CID" > phoenix_firmware_dumper/.tg_cid 
              echo "$T_MID" > phoenix_firmware_dumper/.tg_mid
          
              
              
              
       - name: Setup Dumpyara environment
         working-directory: phoenix_firmware_dumper
         run: |
              sudo bash setup.sh

       - name: Setup config envs And Begin Dump
         working-directory: phoenix_firmware_dumper       
         run: |
              GITHUB_ORG_NAME="dump-sauraj"
              GITLAB_ORG_NAME="sauraj-dumps"
              GITLAB_USERNAME="ksauraj"
              GITHUB_USERNAME="saurajbot"
              GIT_CONFIG_USERNAME="ksauraj"
              GIT_CONFIG_EMAIL="rommirrorer@gmail.com"
              GIT_GITHUB_TOKEN="${{ secrets.GIT_GITHUB_TOKEN }}"
              GITLAB_TOKEN="${{ secrets.GITLAB_TOKEN }}"
              TG_BOT_TOKEN="${{ secrets.TG_BOT_TOKEN }}"
              TG_CHAT_ID="@saurajdumps"
              GITLAB_HOSTNAME="gitlab.com" ## use 'gitlab.com' by default, or use your own github instance, or any public one
              echo "$GITHUB_ORG_NAME" > .github_orgname
              echo "$GITLAB_HOSTNAME" > .gitlab_instance
              echo "$GIT_GITHUB_TOKEN" > .github_token
              echo "$GITLAB_ORG_NAME" > .gitlab_orgname
              echo "$GITLAB_USERNAME" > .gitlab_username
              echo "$GITHUB_USERNAME" > .github_username
              echo "$GITLAB_TOKEN" > .gitlab_token
              echo "$TG_BOT_TOKEN" > .tg_token
              echo "$TG_CHAT_ID" > .tg_chat
              echo "1297553238" > .tg_chat_id
              export GIT_TOKEN=${{ secrets.GIT_GITHUB_TOKEN }}
              export TG_API=${{ secrets.TG_BOT_TOKEN }}
              export PUSH_TO_GITLAB=true
              export TG_TOKEN="$TG_API"
              export GIT_TKN=${{ secrets.GIT_GITHUB_TOKEN }}
              export CHAT_ID="$TG_CHAT_ID"
              export C_ID="$T_CID"
              export M_ID="$T_MID"
              #Do Not Edit This
              git config --global user.name "$GIT_CONFIG_USERNAME"
              git config --global user.email "$GIT_CONFIG_EMAIL"
              sed -i s/"DroidDumps@github.com"/"$GIT_CONFIG_EMAIL"/g dumper.sh
              sed -i s/"user.name \"DroidDumps\""/"user.name \"$GIT_CONFIG_USERNAME\""/g dumper.sh
              mkdir -p "$HOME"/dump
              mkdir -p "$HOME"/telegram
              sudo bash dumper.sh "$ROM_URL"


#######
env:
  ROM_URL: https://doc-04-84-docs.googleusercontent.com/docs/securesc/0v5mal7vvcq7aj00c7v2no1kos88t8ng/f9r4vcuh8mjgpoev6s8v4b74sglu9f51/1680712800000/07062488354010093269/04159493319860129849/1STszGH_xJNKQsCYLYazQnoLL3MxqDIBR?e=download&ax=ALy03A7KBQ1b7CnmaXKGmg8fhBcDThnJn-_fmi8dQw28hda7L19-IIGrUYW0OIK6EYpGoHWTZYnsoivmH6gJ7TSgsFw0ldfJ64i1yP4fKBy8oSSbu8X7p2M3EIAyRJDV1io7ptKTLuvchizJTT7_qpj7fjBxQcCjLkWF6hcEWMVex2B0Wag0RNYWXDwOcAFIYCcnDjPcg-eWRSw5zcGWmCX0NBPq7DiVwJz97ZZi1Pwk5lq_tShN1UaLdgLd6xJj81WLyL1VPZ283W8OiDldTMDEpF95Hr7CBv07LUmmumlxfdTMGvOl_mF0liLB9ENDfPS9FZ_eh0-x_WUjeBNqyFbeft_mhjzNvP-haSHilaDkUCbgG0sXwOcuZrjr76esVG3u2dp4M2U13fnlqdlCfp45yqAUq_9WKxGIyFfqv3AyjQZIMcjTj39b6emjXhMFdKPcQQFEm4OBCJMDv_YIo1-vYOW3BQ2Zq8O4m6SpBx25m5C7FMlblKM4mqd5BRwEW9CrUWz7oIAXj6VRYgVDidqWyJiPAcdT7B4EWKXbGU0j7k19OwYWfHS2OT5vjHDbWzCivrwvmM3KGro4sQ9H6nLdl8G54C98OdOacJN4wQg6RG7nMj_0MVszNYmFWfnkWU1NNfBx9C4bU3FILAMFlfOCxR30smH4jphnloJgy9aQHdGKNkHXpXGZrv9IsaANNFwFRIFqhvdHdA-HtG8FkHNP-I9B2G7FAWdlR0zV0aoslsEds31i6mWlGKkyCqOTEFQ14QQI6UYYidccY1rb2fH1AbJKLcSZsrC4uTM2ms01WxZs7r0LKOLXb_feNP9_RWcJxNM1K7kzE0kWCAGLewytSKfeFrCMVblN0ZDh1gLD3eYKvsKRBxQ6OvnI7UXfMi6Y2eEenHwRANRfN8EdPSC0EZPgcKyPABr2gSM&uuid=0bd28708-43f3-4f6b-a9b3-025778c9e1b3&authuser=0&nonce=hvbs5dj0htj0m&user=04159493319860129849&hash=bjfb3u9t2f8pv0jl4daepdu6b43juodg
