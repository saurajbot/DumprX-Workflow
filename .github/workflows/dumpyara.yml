name: Dump

on:
  push:
    paths-ignore:
      - '*.md'
    branches: [ main ]

defaults:
  run:
    shell: bash

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
       - name: Checkouts
         uses: actions/checkout@v2

       - name: Clone Dumpyara
         run: |
              git clone --depth=1 --single-branch https://github.com/saurajbot/DumprX.git phoenix_firmware_dumper
              T_CID=$(cat temp/ch_id.txt)
              T_MID=$(cat temp/msg_id.txt)
              echo "$T_CID" > phoenix_firmware_dumper/.tg_cid 
              echo "$T_MID" > phoenix_firmware_dumper/.tg_mid
          
              
              
              
       - name: Setup Dumpyara environment
         working-directory: phoenix_firmware_dumper
         run: |
              sudo bash setup.sh

       - name: Setup config envs And Begin Dump
         working-directory: phoenix_firmware_dumper       
         run: |
              GITHUB_ORG_NAME="dump-sauraj"
              GITLAB_ORG_NAME="sauraj-dumps"
              GITLAB_USERNAME="ksauraj"
              GITHUB_USERNAME="saurajbot"
              GIT_CONFIG_USERNAME="ksauraj"
              GIT_CONFIG_EMAIL="rommirrorer@gmail.com"
              GIT_GITHUB_TOKEN="${{ secrets.GIT_GITHUB_TOKEN }}"
              GITLAB_TOKEN="${{ secrets.GITLAB_TOKEN }}"
              TG_BOT_TOKEN="${{ secrets.TG_BOT_TOKEN }}"
              TG_CHAT_ID="@saurajdumps"
              GITLAB_HOSTNAME="gitlab.com" ## use 'gitlab.com' by default, or use your own github instance, or any public one
              echo "$GITHUB_ORG_NAME" > .github_orgname
              echo "$GITLAB_HOSTNAME" > .gitlab_instance
              echo "$GIT_GITHUB_TOKEN" > .github_token
              echo "$GITLAB_ORG_NAME" > .gitlab_orgname
              echo "$GITLAB_USERNAME" > .gitlab_username
              echo "$GITHUB_USERNAME" > .github_username
              echo "$GITLAB_TOKEN" > .gitlab_token
              echo "$TG_BOT_TOKEN" > .tg_token
              echo "$TG_CHAT_ID" > .tg_chat
              echo "1297553238" > .tg_chat_id
              export GIT_TOKEN=${{ secrets.GIT_GITHUB_TOKEN }}
              export TG_API=${{ secrets.TG_BOT_TOKEN }}
              export PUSH_TO_GITLAB=true
              export TG_TOKEN="$TG_API"
              export GIT_TKN=${{ secrets.GIT_GITHUB_TOKEN }}
              export CHAT_ID="$TG_CHAT_ID"
              export C_ID="$T_CID"
              export M_ID="$T_MID"
              #Do Not Edit This
              git config --global user.name "$GIT_CONFIG_USERNAME"
              git config --global user.email "$GIT_CONFIG_EMAIL"
              sed -i s/"DroidDumps@github.com"/"$GIT_CONFIG_EMAIL"/g dumper.sh
              sed -i s/"user.name \"DroidDumps\""/"user.name \"$GIT_CONFIG_USERNAME\""/g dumper.sh
              mkdir -p "$HOME"/dump
              mkdir -p "$HOME"/telegram
              sudo bash dumper.sh "$ROM_URL"


#######
env:
  ROM_URL: https://download.samfw-premium.cloud/005bf94540fc3098aa19188746af0399NyGd7l9MMmg-3lKaLN-OpgnuLWxZ4jZ5a9RziwuSZ0JhT7qC2OgbzSj2vbgXr3uh6UjTMgGG4bvxOgivMQ-9NUYMm5ynKRVufLi9TlxNeCsyT5tVsh0_qum0QsQEazMpW8JOmW5QPoPq8ij4AtjVag7RTFLfX6KCI5m7lRwrh9KFoIaqswdshJxwYA4fPe7qgaaPgWGjwoLv1EV93_hxWOT_BP-Sb3NJE3DKFLl3QIA9Em_Khx8Aoqkk81DTldENW1WCRDLNVQ-U-xNab5939TsFSkxmEC4qWXsmTH4RdCpdT7gWjEDwbnIwTspHNzuTjwUzXAs0UjDQngyqI65HwbqDfBeZFad8ksku2jFPAViKkYF_7n_xdVRbiqBJpnMQLHq4vpMKlafODxm7p7PmiHhq9NNb6mehLGC3IZ8yjIMdfFSXmVnqMPkiZVOrj7kU2q2NqBlwn3-7pHvLGJoilPcrrqk2RqQW0377Vw-pvE5UfqUqVk_PHB7SFNTPNQ82b-3gUVblyMQCV3hF1LiAuvRgqnd2M6yPP0_wK7ye3pyGGVwfSMTYQyjXRnB1A_qSLDNo_Oo0_fjTfwwiXkoGDKKSlwusanh5ugxAw8_WgYjK-Rj_VzsMu9uiyyqUwSdfCBaCfq0ApLyWtwo0z9qqHkn0bvfBPX9NIdvC_kE32GpEVi58MycIh0i625FMSNt8yuaFQgEQDcuoymG3RV8LfXlHGqR4_hEgX7LFuZK6f-VbfyxjW0vAAxGS0xdnYzewv8G8A249ncL_Krtp198AA-JA3yncaF5fS4fV4dAKvSIt-e3_wJ_QEw7RJS0sO00J0ND1vBbXRbWdRHOcIftpdQ1AQfrnaNvK5jbmDmdWv2Xj6fF_4cWA2TFC_ZNjCvVtDvrhVnfbbqHPDCds8vRlQVEImQ-3PeKqp11IPIiPH0W3uluhFD4vzW96vmPNm9kze4Hv6OQUIczGQ1aL5jrTPrua-NaITaXSzrR6PxRQAVfuy1k40nT0feS3ewLh6dxkuHiZfHkMRrLIX5Zz5q0XH2esggfw8g2k7FfD4VOlPcWxtWtALPq7-Qt9kP2fdR9Rdr-0tlh68mgHhw_vV2eoFQ?file_name=SAMFW.COM_SM-G990E_THL_G990EXXU7FWK6_fac.zip
